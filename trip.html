<html>

<head>
	<meta charset="UTF8" />
	<title>Trip Translator</title>
	<link rel="icon" href="https://common.ets2mcg.com/img/favicon.ico" type="image/x-icon">
	<meta name="theme-color" content="#f7d331">
	<script src="js/jquery-3.5.1.min.js"></script>
	<script src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js" crossorigin="anonymous"></script>
	<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap"
		rel="stylesheet">
	<style>
		:root {
			font-family: 'Noto Sans KR', sans-serif;
		}

		#input {
			height: 500px;
			margin: 0 auto;
			display: block;
		}

		.marginVert {
			margin: 10px 0px;
		}

		.pageBlock {
			width: 100%;
		}

		body {
			background-color: #ffffff;
			margin: 0;
		}

		button {
			padding: 20px 0px;
		}

		div.page {
			margin: 0 auto;
			padding: 50px 100px;
			width: calc(1000px - 200px);
			background-color: #ababab;
		}

		h1 {
			padding: 0px;
			margin: 0px;
		}

		img.emoji {
			height: 1em;
			width: 1em;
			margin: 0 .05em 0 .1em;
			vertical-align: -0.1em;
		}

		textarea {
			background-color: white;
			color: black;
		}

		.wordElem {
			display: inline-block;
		}

		@media (max-width: 1200px) {
			div.page {
				padding: 50px;
				width: calc(100% - 100px);
			}
		}

		@media (prefers-color-scheme: dark) {
			:root {
				color: white;
			}

			body {
				background-color: #000000;
			}

			div.page {
				background-color: #333333;
			}

			textarea {
				background-color: black;
				color: white;
			}
		}
	</style>
</head>

<body>
	<div class="page">
		<h1 class="emojiIncluded">Auto trip translator for MCG 🇰🇷</h1>
		<h2>Trip Route Text Here</h2>
		<textarea id="input" class="pageBlock" placeholder="Put trip route text here"></textarea>
		<button id="process" type="submit" class="marginVert pageBlock">Process!</button>
		<div id="result" style="display: none;">
			<h2>Result here</h2>

		</div>
	</div>
	<script>
		const artChars = "▀█";
		const keywords = new Map();
		function put(key, val) {
			keywords.set(key, val);
		}
		//City Names
		put("Amsterdam", "암스테르담");
		put("Bern", "베른");
		put("Berlin", "베를린");
		put("Bremen", "브레멘");
		put("Calais", "칼레");
		put("Carlisle", "칼라일");
		put("Cologne", "쾰른");
		put("Dijon", "디종");
		put("Dortmund", "도르트문트");
		put("Dover", "도버");
		put("Duisburg", "뒤스부르크");
		put("Dusseldorf", "뒤셀도르프");
		put("Erfurt", "에르푸르트");
		put("Frankfurt am Main", "프랑크푸르트 암 마인");
		put("Frankfurt", "프랑크푸르트");
		put("Graz", "그라츠");
		put("Hamburg", "함부르크");
		put("Hannover", "하노버");
		put("Innsbruck", "인스브루크");
		put("Klagenfurt", "클라겐푸르트");
		put("London", "런던");
		put("Luxembourg", "룩셈부르크");
		put("Lyon", "리옹");
		put("Mannheim", "만하임");
		put("Metz", "메스");
		put("Milan", "밀라노");
		put("Munich", "뮌헨");
		put("Nuremberg", "뉘른베르크");
		put("Paris", "파리");
		put("Prague", "프라하");
		put("Reims", "랭스");
		put("Rotterdam", "로테르담");
		put("Salzburg", "잘츠부르크");
		put("Strasbourg", "스트라스부르");
		put("Szczecin", "슈체친");
		put("Venice", "베네치아");
		put("Verona", "베로나");
		put("Zurich", "취리히");
		put("Stuttgart", "슈투트가르트");

		//Company Names
		put("Quarry", "채석장");
		put("Service", "정비소");
		put("Car Parking", "주차장");
		put("LKW", "LKS");
		put("Strokes", "발작");
		put("Port calais", "칼레 항구");
		put("Port Calais", "칼레 항구");
		put("Port dover", "도버 항구");
		put("Port Dover", "도버 항구");

		//Month Names
		put("January", "01");
		put("February", "02");
		put("March", "03");
		put("April", "04");
		put("May", "05");
		put("June", "06");
		put("July", "07");
		put("August", "08");
		put("September", "09");
		put("October", "10");
		put("November", "11");
		put("December", "12");

		//Color Names
		put("Blue", "파란색");
		put("Red", "빨간색");
		put("Green", "초록색");
		put("Orange", "주황색");
		put("White", "흰색");

		//Other Texts
		put("(Gas Station)", "(주유소)");
		put("Point 1 and 3", "1, 3 포인트");

		function translateWords(text) {
			var text0 = "";
			text0 = text;
			for (let v of keywords.keys()) {
				while (text0.includes(v))
					text0 = text0.replace(v, keywords.get(v));
			}
			return text0;
		}
		function isArtLine(text) {
			var strText = "";
			strText = text;
			for (let i = 0; i < strText.length; i++) {
				if (artChars.includes(strText.charAt(i))) {
					return true;
				}
			}
			return false;
		}
		$(document).ready(() => {
			$(".emojiIncluded").each((_, elem) => {
				twemoji.parse(elem), {
					folder: 'svg',
					ext: 'svg'
				};
			})

			$("#process").click(() => {
				var resultDiv = $("#result");
				resultDiv.empty();
				resultDiv.show();

				var text = "";
				text = $("#input").val().trim();

				var buffer = "";

				function appendText() {
					let n = $("<div />").text(buffer).addClass("wordElem");
					resultDiv.append(n);
					resultDiv.append($("<div />").html("&nbsp;").addClass("wordElem"));
					buffer = "";
				}

				function appendLine() {
					resultDiv.append($("<br />"));
				}

				var lines = text.split('\n');
				function processLine(i) {
					let curLine = lines[i];
					if (isArtLine(curLine)) {
						buffer = curLine;
						appendText();
						appendLine();
						continue;
					} else if (curLine.includes("Notified") || curLine.includes("@everyone")) {
						buffer = "<@666307984644898826>";
						appendText();
						appendLine();
						continue;
					} else if (curLine.match(/.*★\s*ETS2MCG [tT][hH][eE] [tT][rR][iI][pP] [oO][nN] (.*[dD][aA][yY])\s*★.*/)) {
						let dayName = curLine.match(/.*★\s*ETS2MCG [tT][hH][eE] [tT][rR][iI][pP] [oO][nN] (.*[dD][aA][yY])\s*★.*/)[1].toLowerCase();
						if (dayName === "sunday") {
							dayName = "일요일";
						} else if (dayName === "monday") {
							dayName = "월요일";
						} else if (dayName === "tuesday") {
							dayName = "화요일";
						} else if (dayName === "wednesday") {
							dayName = "수요일";
						} else if (dayName === "thursday") {
							dayName = "목요일";
						} else if (dayName === "friday") {
							dayName = "금요일";
						} else if (dayName === "saturday") {
							dayName = "토요일";
						}
						buffer = "★ ETS2MCG " + dayName + " 여행 ★";
						appendText();
						appendLine();
						continue;
					} else if (curLine.includes("ETS2MCG Team Convoy")) {
						buffer = "★ ETS2MCG 팀 컨보이 ★";
						appendText();
						appendLine();
						continue;
					} else if (curLine.includes("★") && (curLine.includes("Convoy") || curLine.includes("DLC") || curLine.includes("Trip"))) {
						buffer = curLine;
						appendText();
						appendLine();
						continue;
					}

					if (curLine.startsWith("Date:")) {
						let date = curLine.substring(5).trim();
						let dates = date.split(" ");
						if (dates.length == 3) {
							let year = dates[2];
							let month = dates[1];
							let day = dates[0];

							if (day.length == 1) day = "0" + day;
							curLine = "날짜: " + year + "-" + month + "-" + day;
						} else {
							curLine = "날짜: " + date;
						}
					} else if (curLine.startsWith("Route:")) {
						curLine = "경로:" + curLine.substring(6);
					} else if (curLine.startsWith("Start:")) {
						curLine = "출발:" + curLine.substring(6);
					} else if (curLine.startsWith("Stop:")) {
						curLine = "정차:" + curLine.substring(5);
					} else if (curLine.startsWith("Finish:")) {
						curLine = "도착:" + curLine.substring(7);
					} else if (curLine.startsWith("Truck:")) {
						curLine = "트럭:" + curLine.substring(6);
					} else if (curLine.startsWith("Trailer:")) {
						let data = curLine.substring(8);
						if (data.includes("Own Trailer")) {
							data = " 자유";
						}
						curLine = "트레일러:" + data;
					} else if (curLine.startsWith("Skin:")) {
						curLine = "스킨:" + curLine.substring(5);
					} else if (curLine.startsWith("Server:")) {
						curLine = "서버:" + curLine.substring(7);
					} else if (curLine.startsWith("Chassis:")) {
						curLine = "섀시:" + curLine.substring(8);
					} else if (curLine.startsWith("Classic:")) {
						curLine = "(섀시라고 써야되는데 또 클래식이라 썼음)클래식:" + curLine.substring(8);
					} else if (curLine.startsWith("Time:")) {
						curLine = "시간: 22:00";
						buffer = curLine;
						appendText();
						appendLine();
						break;
					} else if (curLine.startsWith("- Truck: ")) {
						curLine = "- 트럭: " + curLine.substring(9);
					} else if (curLine.startsWith("- Trailer: ")) {
						curLine = "- 트레일러: " + curLine.substring(11);
					} else if (curLine.includes("Truck") && curLine.includes("Trailer") && curLine.includes("Skin") && curLine.includes("Free")) {
						curLine = "트럭, 트레일러, 스킨: 자유 (MCG Korea 스킨 사용 가능 <#703089691863285821>)";
					}

					curLine = translateWords(curLine);
					buffer = curLine;
					appendText();
					appendLine();
				}
				function d(i) {
					if (i < lines.length) {
						processLine(i);
						setTimeout(() => d(i + 1), 50);
					}
				}
				d(0);  
				if (buffer.length !== 0) append();
			})
		})
	</script>
</body>

</html>